# BRAIN-IoT service robotic .travis-ci.yml
# https://docs.gitlab.com/ce/ci/yaml/

# docker image with maven 3 and java 11
#image: maven:3-jdk-11

################
### Language ###
################
language: java

###########
### JDK ###
###########
jdk:
  - oraclejdk11


env:
  MAVEN_OPTS: "-Dmaven.repo.local=.m2/repository"
  MAVEN_CLI_OPTS: "'-s .m2/settings.xml -B'"
  MAVEN_DEPLOY_OPTS: "'-DaltReleaseDeploymentRepository=brain-iot-releases::default::https://nexus.repository-pert.ismb.it/repository/maven-releases -DaltSnapshotDeploymentRepository=brain-iot-snapshots::default::https://nexus.repository-pert.ismb.it/repository/maven-snapshots'"
#  CI_DEBUG_TRACE: "true"
  global:
  - secure:
    BKe36cP+z04VFmlrRUGhluTunDPJC+Aps8ksta5K0LGgnZeI+Geuq0Ccwds/qt5uB9ulKCg9cWYOwE24St96PSic+K4CgJ+NecxHWNjqDn1uIrj05e869k3MMg30WGMivwx9pMnH5f2qec8ZCnZxe4XbHEzLopdGMjxWTHHiy5mnHAP6aFY8M32dvd1VbFmLzBOjOMZi78NLaHd5GJHJKL0M2sVyILqsr3a4rLoNe8mvJ8hljbema/oPCy1sRZ7IKtTRWoeOPXXuWmrntRwPDydLS83AmftgAbtp+aSNBJ9vCeCi0jbXnDy1ThjItzq80ov6Dex3jcZ19ROvQr3I63FzpRyftgAE7wSiNOXBavB7yIu8n37HHaBCieFicRiFMTpEMK8XwuJ0hSagzfDb2p9S3lB9CDkmDb6W+nbmSFPAtxWan5exes7JtfEsVFSWt0PylXv3W1mNrDyO/gy3hCl8JoEcABNWhbh56H9ew7Q1g7Rhs3Sj+0c3Dw49GA+HBPzrlXVYNSfzF1AFdopvDORd0NOUHhd5gFXS1O/Trodof+nic4L8fLJ4Xbr2Hwk7/Z4m90nJBBOPTcq6fceJQDwUQzLGzhIAMTEwqIitmbEyvxpaFog7mcmEUYXnQNCWZ2TyZgQ1bphBfrGSu3nTEy4SPPWC6240j96QQd/TZnE=
  - secure: 
    N/Xb2vfh86ohX8uI/SzaepeUMU0Jxjhb2oTWOSUSS5snWB0Qryzk0d4Umh0ngTrxbW1BlLMpy63EbL74VWG6jZ0MN/mP1NZA41yWPhFn+CEwT9jAyFv4lmtflFk4BEnqcga40rzoGmP828zk6VahHa6h+Q6qWznPLYiLAp4PrX6II6zuGwY0d12Qhnsl7/o1ReOVbm43TR5RE55bDRGtpRunQKAlRVG5BhTusZuN9NkXI/AuOMsJAS0QNnHirH2fgXqYDHpSl8rN/c0w2m00cw8DCMWQqCocYG4S4EuL2g8APzpfBjf7rj9kkzMKiqrrhKS62rv5gROdy7DbNVFMui90MsWUDMBZ8BSA1bsm84BtMkg1TXwq8lG+XPDhpfZlp6rQVdcMIGNddddrm6qsZnNLABICZ4GOi2UexHs0i0gczVkmfe08K9jrTrRSUOtmE+YXTcqWSX2YnbxtFgj+exq9WlJEmkTix7+af4Yk/Z48ucpbgHUQiZSiKrdiNl/80JpiyiXZrWihGfW1K0pcgWBaeW7nmu8djkuJ7ieUq1wa5h+UNSPD6ib24d09GnPbhHmwMRQ0uDbOLSCvVTbb2ueam0dyHiScP02sBK+1kY2JsLHn8tDIDYsy2Y4p8ptDPqGQleGTGSAT4510+kPwIO4tAW3nYjhZZua9P3BMrmc=


  
# Cache downloaded dependencies and plugins between builds.
cache:
  directories:
    - $HOME/.m2/repository

before_install:
    - wget https://archive.apache.org/dist/maven/maven-3/3.6.3/binaries/apache-maven-3.6.3-bin.zip
    - unzip -qq apache-maven-3.6.3-bin.zip
    - export M2_HOME=$PWD/apache-maven-3.6.3
    - export PATH=$M2_HOME/bin:$PATH

install:
    - mvn $MAVEN_CLI_OPTS package bnd-resolver:resolve

script:
    - mvn $MAVEN_CLI_OPTS bnd-export:export


after_success:
     - mvn $MAVEN_CLI_OPTS $MAVEN_DEPLOY_OPTS clean package org.apache.maven.plugins:maven-deploy-plugin:2.8.2:deploy


#end